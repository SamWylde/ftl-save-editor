<Window x:Class="FtlSaveEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="FTL Save Editor" Height="800" Width="1200"
        MinHeight="600" MinWidth="900"
        Background="{StaticResource BgDarkBrush}"
        WindowStartupLocation="CenterScreen">

    <Window.InputBindings>
        <KeyBinding Key="O" Modifiers="Ctrl" Command="{Binding OpenCommand}"/>
        <KeyBinding Key="S" Modifiers="Ctrl" Command="{Binding SaveCommand}"/>
        <KeyBinding Key="S" Modifiers="Ctrl+Shift" Command="{Binding SaveAsCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Background="{StaticResource BgMediumBrush}"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1"
                Padding="8,6">
            <DockPanel>
                <!-- File buttons (left) -->
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <Button x:Name="OpenButton" Content="Open" Style="{StaticResource DarkButton}"
                            Click="OpenFile_Click" Margin="0,0,6,0"/>
                    <Button x:Name="SaveButton" Content="Save" Style="{StaticResource DarkButton}"
                            Click="SaveFile_Click" Margin="0,0,6,0" IsEnabled="False"/>
                    <Button x:Name="SaveAsButton" Content="Save As" Style="{StaticResource DarkButton}"
                            Click="SaveFileAs_Click" IsEnabled="False"/>
                    <TextBlock x:Name="DirtyIndicator" Text="  * unsaved changes"
                               Foreground="{StaticResource AccentOrangeBrush}"
                               VerticalAlignment="Center" Margin="12,0,0,0"
                               Visibility="Collapsed"/>
                </StackPanel>

                <!-- Mode toggle (right) -->
                <Border DockPanel.Dock="Right" Background="{StaticResource BgDarkBrush}"
                        BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                        CornerRadius="4" Margin="12,0,0,0" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <Button x:Name="EditorModeBtn" Content="Save Editor"
                                Click="EditorMode_Click" Padding="12,5" Cursor="Hand">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="{StaticResource AccentBlueBrush}"/>
                                    <Setter Property="Foreground" Value="#FF0D1117"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        Padding="{TemplateBinding Padding}"
                                                        CornerRadius="3,0,0,3">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>
                        <Button x:Name="TrainerModeBtn" Content="Trainer"
                                Click="TrainerMode_Click" Padding="12,5" Cursor="Hand">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="FontWeight" Value="Normal"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        Padding="{TemplateBinding Padding}"
                                                        CornerRadius="0,3,3,0">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Border>

                <!-- Spacer -->
                <Border/>
            </DockPanel>
        </Border>

        <!-- Main content area -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Editor Sidebar -->
            <Border x:Name="EditorSidebarBorder" Grid.Column="0" Background="{StaticResource BgMediumBrush}"
                    BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="SidebarPanel" Margin="0,8,0,0"/>
                </ScrollViewer>
            </Border>

            <!-- Trainer Sidebar -->
            <Border x:Name="TrainerSidebarBorder" Grid.Column="0" Background="{StaticResource BgMediumBrush}"
                    BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0"
                    Visibility="Collapsed">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="TrainerSidebarPanel" Margin="0,8,0,0"/>
                </ScrollViewer>
            </Border>

            <!-- Editor Content -->
            <ScrollViewer x:Name="EditorContentScroller" Grid.Column="1" VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
                <Border Padding="20">
                    <StackPanel x:Name="ContentPanel">
                        <Border x:Name="ParseModeBanner"
                                Background="{StaticResource BgMediumBrush}"
                                BorderBrush="{StaticResource AccentOrangeBrush}"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="12,10"
                                Margin="0,0,0,12"
                                Visibility="Collapsed">
                            <TextBlock x:Name="ParseModeBannerText"
                                       Foreground="{StaticResource AccentOrangeBrush}"
                                       FontSize="12"
                                       TextWrapping="Wrap"/>
                        </Border>

                        <!-- Welcome screen (shown when no file loaded) -->
                        <StackPanel x:Name="WelcomePanel">
                            <TextBlock Text="FTL Save Editor" FontSize="28" FontWeight="Bold"
                                       Foreground="{StaticResource AccentBlueBrush}"
                                       Margin="0,20,0,8"/>
                            <TextBlock Text="Supports Vanilla, Hyperspace, and Multiverse save files"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       FontSize="14" Margin="0,0,0,24"/>

                            <TextBlock Text="Detected Save Files" FontSize="16" FontWeight="SemiBold"
                                       Margin="0,0,0,12"/>
                            <StackPanel x:Name="DetectedFilesPanel"/>

                            <Button Content="Browse for Save File..."
                                    Style="{StaticResource DarkButton}"
                                    Click="OpenFile_Click" Margin="0,16,0,0"
                                    HorizontalAlignment="Left"/>
                        </StackPanel>

                        <!-- Editor content (shown when file is loaded) -->
                        <StackPanel x:Name="EditorPanel" Visibility="Collapsed"/>
                    </StackPanel>
                </Border>
            </ScrollViewer>

            <!-- Trainer Content -->
            <ScrollViewer x:Name="TrainerContentScroller" Grid.Column="1" VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled" Visibility="Collapsed">
                <Border Padding="20">
                    <StackPanel x:Name="TrainerContentPanel"/>
                </Border>
            </ScrollViewer>
        </Grid>

        <!-- Status bar -->
        <Border Grid.Row="2" Background="{StaticResource BgMediumBrush}"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0"
                Padding="12,4">
            <TextBlock x:Name="StatusText" Text="No file loaded"
                       Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
        </Border>
    </Grid>
</Window>
